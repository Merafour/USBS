From: WizBrother WizMime<support@wizbrother.com>
Subject: =?gb2312?B?VVNCU9LG1rIgU1RNMzJGNCBOTzEwo7rBrLv6vOyy4g==?=
Date: Date: Fri, 19 Jun 2015 01:03:21 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0174995343.827"

This is a multi-part message in MIME format.

------=_Next_Part_0174995343.827
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0058331781.436"


------=_Next_Part_0058331781.436
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0058331781.436
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">=0A=
<HTML><HEAD>=0D=0A<meta http-equiv=3D"Content-Type" content=3D"te=
xt/html; charset=3Dgb2312"><TITLE>Untitled</TITLE>=0A=0A<STYLE ty=
pe=3Dtext/css>=0Abody, p, th, td, li, ul, ol, h1, h2, h3, h4, h5,=
 h6, pre=0A{=0A	font-family: =CB=CE=CC=E5;=0A	line-height: 1.4;=0A=
}=0Abody, p, th, td, li, ul, ol, pre=0A{=0A	font-size: 12px;=0A}=0A=
</STYLE>=0A=0A<META content=3D"MSHTML 6.00.2900.6550" name=3DGENE=
RATOR></HEAD>=0A<BODY><FONT face=3D"Times New Roman"><FONT size=3D=
7><STRONG>USBS=D2=C6=D6=B2 STM32F4 =0ANO10=A3=BA=C1=AC=BB=FA=BC=EC=
=B2=E2<BR></STRONG></FONT><FONT =0Asize=3D3>&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =0A--------<SPAN cl=
ass=3DApple-converted-space>&nbsp;</SPAN></FONT></FONT><SPAN =0As=
tyle=3D"FONT-FAMILY: =CB=CE=CC=E5"><FONT size=3D3>=D7=AA=D4=D8=C7=
=EB=D7=A2=C3=F7=B3=F6=B4=A6<BR><FONT =0Aface=3D"Times New Roman">=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
; =0A--------<SPAN class=3DApple-converted-space>&nbsp;=B8=FC=B6=E0=
=B1=CA=BC=C7=C7=EB=B7=C3=CE=CA=A3=BA<A =0Ahref=3D"http://merafour=
.blog.163.com/">merafour.blog.163.com</A>&nbsp;</SPAN></FONT></FO=
NT></SPAN> =0A=0A<P class=3DMsoNormal =0Astyle=3D"MARGIN: 0cm 0cm=
 0pt; WORD-SPACING: 0px; FONT: 12px/16px =CB=CE=CC=E5; TEXT-TRANS=
FORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: nor=
mal; LETTER-SPACING: normal; orphans: auto; widows: auto; webkit-=
text-stroke-width: 0px"><FONT =0Asize=3D3><SPAN style=3D"FONT-FAM=
ILY: =CB=CE=CC=E5"><SPAN lang=3DEN-US><FONT =0Aface=3D"Times New=20=
Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp; =0A</FONT></SPAN></SPAN><SPAN lang=3DEN-US><FONT face=3D=
"Times New Roman">-------- =0A2015-6-17.</FONT></SPAN><SPAN style=
=3D"FONT-FAMILY: =CB=CE=CC=E5">=C0=E4=D4=C2=D7=B7=B7=E7</SPAN><SP=
AN =0Alang=3DEN-US><FONT face=3D"Times New Roman"></FONT></SPAN><=
/FONT></P>=0A<P class=3DMsoNormal =0Astyle=3D"MARGIN: 0cm 0cm 0pt=
; WORD-SPACING: 0px; FONT: 12px/16px =CB=CE=CC=E5; TEXT-TRANSFORM=
: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal;=
 LETTER-SPACING: normal; orphans: auto; widows: auto; webkit-text=
-stroke-width: 0px"><FONT =0Asize=3D3><SPAN lang=3DEN-US><FONT =0A=
face=3D"Times New Roman"><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN =0Aclass=3DApple-converted-=
space>&nbsp;</SPAN></SPAN>-------- =0Aemail</FONT></SPAN><SPAN st=
yle=3D"FONT-FAMILY: =CB=CE=CC=E5">=A3=BA</SPAN><SPAN lang=3DEN-US=
><FONT =0Aface=3D"Times New Roman"><A =0Ahref=3D"mailto:merafour@=
163.com">merafour@163.com</A><SPAN =0Aclass=3DApple-converted-spa=
ce>&nbsp;</SPAN></FONT></SPAN></FONT><BR></P>=0A<HR>=0A=0A<P clas=
s=3DMsoNormal =0Astyle=3D"MARGIN: 0cm 0cm 0pt; WORD-SPACING: 0px;=
 FONT: 12px/16px =CB=CE=CC=E5; TEXT-TRANSFORM: none; COLOR: rgb(0=
,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: nor=
mal; orphans: auto; widows: auto; webkit-text-stroke-width: 0px">=
<BR><FONT =0Acolor=3D#ff0000>&nbsp;&nbsp;&nbsp; <STRONG><SPAN id=3D=
wiz_font_size_span_25612281 =0Astyle=3D"FONT-SIZE: 16pt"><STRONG>=
USBS</STRONG></SPAN></STRONG>=D7=EE=B3=F5=CA=C7=B1=CA=D5=DF=BB=F9=
=D3=DA =0ASTM32F103=CF=B5=C1=D0=BF=AA=B7=A2=B3=F6=C0=B4=B5=C4=D2=BB=
=B8=F6 =0Abootloader=A3=AC=CD=A8=B9=FD=B0=D1=C9=E8=B1=B8=D7=F6=B3=
=C9=D2=BB=B8=F6USB=BD=D3=BF=DA=B5=C4=B4=E6=B4=A2=C9=E8=B1=B8=BC=B4=
U=C5=CC=B4=D3=B6=F8=B0=DA=CD=D1=D2=D4=CD=F9=C9=FD=BC=B6=B9=CC=BC=FE=
=B9=FD=B3=CC=D6=D0=CB=F9=D0=E8=D2=AA=B5=C4=C9=CF=CE=BB=BB=FA=B8=FA=
=C7=FD=B6=AF(=BC=B4=C3=E2=C7=FD)=A1=A3USBS=C8=AB=B3=C6=CA=C7=A3=BA=
"USB =0AStorage"=A3=AC=BE=DF=D3=D0=D2=BB=CF=C2=CC=D8=B5=E3=A3=BA<=
BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =D2=BB=A1=A2=D6=
=BB=D2=AA=C4=E3=B5=C4=B2=D9=D7=F7=CF=B5=CD=B3=D6=A7=B3=D6 =0AU=C5=
=CC=D4=AD=D4=F2=C9=CF=B6=BC=BF=C9=D2=D4=CA=B9=D3=C3=A3=AC=C4=BF=C7=
=B0=D2=D1=BE=AD=B2=E2=CA=D4=C1=CB =0AWindows=A1=A2Ubuntu=B8=FA=C6=
=BB=B9=FB=A3=BB<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =B6=
=FE=A1=A2=BF=C9=CD=A8=B9=FD =0APC=B6=CB=C8=ED=BC=FE=C5=E4=D6=C3=CB=
=F9=CA=B9=D3=C3=B5=C4 IO=B2=A2=C9=E8=D6=C3=C6=E4=D3=E0 IO=B5=C4=C4=
=AC=C8=CF=CA=E4=B3=F6=A3=AC=D2=B2=BE=CD=CA=C7=CB=B5=BC=EC=B2=E2 I=
O=B8=FA LED=D6=B8=CA=BE =0AIO=D3=C3=BB=A7=BF=C9=D2=D4=D7=D4=B6=A8=
=D2=E5=A3=BB<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =C8=FD=
=A1=A2=D7=D4=B4=F8=B2=BB=D2=C0=C0=B5=CD=E2=B2=BF EEPROM=B5=C4=BC=D3=
=C3=DC=CB=E3=B7=A8=A3=AC =0A32B=BC=D3=C3=DC=CA=FD=BE=DD=C8=B7=B1=A3=
=B3=CC=D0=F2=B6=C1=B5=BD=C1=ED=CD=E2=D2=BB=BF=C5 IC=C9=CF=B2=BB=C4=
=DC=D4=CB=D0=D0=A3=BB<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p; =CB=C4=A1=A2=CE=AA =0AApp=CC=E1=B9=A9=B5=A5=B6=C0=B5=C4=BC=D3=C3=
=DC=CB=E3=B7=A8(32B)=A3=AC=D3=C3=BB=A7=BF=C9=CD=A8=B9=FD PC=C8=ED=
=BC=FE=C9=E8=D6=C3=BC=D3=C3=DC "licence"=A1=A3</FONT><BR><BR>&nbs=
p;&nbsp;&nbsp; =0A<STRONG><SPAN id=3Dwiz_font_size_span_17581296=20=
=0Astyle=3D"FONT-SIZE: 16pt"><STRONG>=C7=B0</STRONG></SPAN></STRO=
NG>=C3=E6=CE=D2=C3=C7=D2=D1=BE=AD=CA=B5=CF=D6=C1=CB=D2=FD=B5=BC=B9=
=CC=BC=FE=A3=AC=D5=E2=C0=EF=CE=D2=C3=C7=BE=CD=B6=D4=B0=B4=BC=FC=B5=
=C4=BC=EC=B2=E2=BD=F8=D0=D0=D3=C5=BB=AF=A1=A3&nbsp;&nbsp;<BR><BR>=
&nbsp;&nbsp;&nbsp; =0A<SPAN id=3Dwiz_font_size_span_28458765 =0As=
tyle=3D"FONT-SIZE: 16pt"><STRONG>=CD=AC</STRONG></SPAN>=D1=F9=BD=AB=
=C9=CF=D2=BB=B2=BD=B5=C4=D4=B4=C2=EB=BF=BD=B1=B4=D2=BB=B7=DD=A3=AC=
=B2=A2=C3=FC=C3=FB=CE=AA=A3=BAUSBS_V0.9.21=A1=A3<BR><BR>&nbsp;&nb=
sp;&nbsp; =0A<STRONG><SPAN id=3Dwiz_font_size_span_26197984 =0Ast=
yle=3D"FONT-SIZE: 16pt"><STRONG>=B4=F2</STRONG></SPAN></STRONG>=BF=
=AA=B9=A4=B3=CC=A3=AC=CE=D2=C3=C7=BD=AB=D2=FD=B5=BC=B9=CC=BC=FE=B5=
=A5=B6=C0=CC=E1=C8=A1=D2=BB=B8=F6=BA=AF=CA=FD=A3=AC=B2=A2=D4=F6=BC=
=D3 =0Acode_entry=BA=AF=CA=FD=A3=BA<BR></P>=0A<DIV =0Astyle=3D"BO=
RDER-RIGHT: black 1px solid; PADDING-RIGHT: 3px; BORDER-TOP: blac=
k 1px solid; PADDING-LEFT: 3px; FONT-SIZE: 12px; MARGIN-LEFT: aut=
o; BORDER-LEFT: black 1px solid; COLOR: black; MARGIN-RIGHT: auto=
; PADDING-TOP: 3px; BORDER-BOTTOM: black 1px solid; FONT-FAMILY:=20=
Courier New; BACKGROUND-COLOR: window; TEXT-ALIGN: left; 3px: "><=
FONT =0Acolor=3D#0000ff><B>typedef</B></FONT>&nbsp;&nbsp;<FONT =0A=
color=3D#0000ff><B>void</B></FONT> (<FONT color=3D#333399>*</FONT=
>pFunction)(<FONT =0Acolor=3D#0000ff><B>void</B></FONT>);<BR><FON=
T color=3D#0000ff><B>static</B></FONT> =0ApFunction Jump_To_Appli=
cation;<BR><FONT color=3D#0000ff><B>static</B></FONT> =0Auint32_t=
 JumpAddress;<BR>#<FONT color=3D#0000ff><B>define</B></FONT> =0AA=
PP_DEFAULT_ADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x08008000 =0A=
<FONT color=3D#008000>/* The first 2 sectores (32 KB) are reserve=
d for DFU code =0A*/</FONT><BR><FONT color=3D#0000ff><B>static</B=
></FONT> <FONT =0Acolor=3D#0000ff><B>void</B></FONT> boot_app(<FO=
NT =0Acolor=3D#0000ff><B>void</B></FONT>)<BR>{<BR>&nbsp;&nbsp;&nb=
sp;&nbsp;<FONT =0Acolor=3D#0000ff><B>if</B></FONT> (((<FONT color=
=3D#333399>*</FONT>(__IO =0Auint32_t<FONT color=3D#333399>*</FONT=
>)APP_DEFAULT_ADD) <FONT =0Acolor=3D#333399>&amp;</FONT> 0x2FFE00=
00 ) <FONT color=3D#333399>=3D=3D</FONT> =0A0x20000000)<BR>&nbsp;=
&nbsp;&nbsp;&nbsp;{ <FONT color=3D#008000>/* Jump to user =0Aappl=
ication */</FONT><BR>&nbsp;&nbsp;JumpAddress <FONT color=3D#33339=
9>=3D</FONT> =0A<FONT color=3D#333399>*</FONT>(__IO uint32_t<FONT=
 color=3D#333399>*</FONT>) =0A(APP_DEFAULT_ADD <FONT color=3D#333=
399>+</FONT> <FONT =0Acolor=3D#6e00aa>4</FONT>);<BR>&nbsp;&nbsp;J=
ump_To_Application <FONT =0Acolor=3D#333399>=3D</FONT> (pFunction=
) JumpAddress;<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#008000>/* Initial=
ize user application's Stack Pointer =0A*/</FONT><BR>&nbsp;&nbsp;=
__set_MSP(<FONT color=3D#333399>*</FONT>(__IO =0Auint32_t<FONT co=
lor=3D#333399>*</FONT>) =0AAPP_DEFAULT_ADD);<BR>&nbsp;&nbsp;Jump_=
To_Application();<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff><B>whil=
e</B></FONT>(<FONT =0Acolor=3D#6e00aa>1</FONT>)NVIC_SystemReset()=
; <FONT color=3D#008000>// Program =0AReset</FONT><BR>&nbsp;&nbsp=
;&nbsp;&nbsp;}<BR>}<BR><FONT =0Acolor=3D#0000ff><B>static</B></FO=
NT> <FONT color=3D#0000ff><B>void</B></FONT> =0Acode_entry(<FONT=20=
color=3D#0000ff><B>void</B></FONT>)<BR>{<BR>&nbsp;uint8_t =0Adown=
<FONT color=3D#333399>=3D</FONT><FONT color=3D#6e00aa>0</FONT>;<B=
R>&nbsp;<FONT =0Acolor=3D#0000ff><B>unsigned</B></FONT> <FONT col=
or=3D#0000ff><B>int</B></FONT> =0Aled<FONT color=3D#333399>=3D</F=
ONT><FONT color=3D#6e00aa>0</FONT>;<BR>&nbsp;<FONT =0Acolor=3D#00=
00ff><B>unsigned</B></FONT> <FONT color=3D#0000ff><B>int</B></FON=
T> =0Acount<FONT color=3D#333399>=3D</FONT><FONT color=3D#6e00aa>=
0</FONT>;<BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>unsigned</B></FONT=
> <FONT color=3D#0000ff><B>int</B></FONT> =0Aclock<FONT color=3D#=
333399>=3D</FONT><FONT color=3D#6e00aa>0</FONT>;<BR>&nbsp;<FONT =0A=
color=3D#008000>/************************ Boot App =0A***********=
******************/</FONT><BR>&nbsp;clock <FONT =0Acolor=3D#33339=
9>=3D</FONT> <FONT color=3D#6e00aa>0</FONT>;<BR>&nbsp;count <FONT=
 =0Acolor=3D#333399>=3D</FONT> clock<FONT color=3D#333399>+</FONT=
><FONT =0Acolor=3D#6e00aa>200</FONT>; <FONT color=3D#008000>// 0.=
2s</FONT><BR>&nbsp;led <FONT =0Acolor=3D#333399>=3D</FONT> clock<=
FONT color=3D#333399>+</FONT><FONT =0Acolor=3D#6e00aa>50</FONT>;=20=
<FONT color=3D#008000>// 0.05s</FONT><BR>&nbsp;<FONT =0Acolor=3D#=
0000ff><B>for</B></FONT>(clock<FONT color=3D#333399>=3D</FONT><FO=
NT =0Acolor=3D#6e00aa>0</FONT>; clock<FONT color=3D#333399>&lt;</=
FONT><FONT =0Acolor=3D#6e00aa>400</FONT>; clock <FONT color=3D#33=
3399>+=3D</FONT> <FONT =0Acolor=3D#6e00aa>10</FONT>)<BR>&nbsp;{<B=
R>&nbsp;&nbsp;delay_ms(<FONT =0Acolor=3D#6e00aa>10</FONT>);<BR>&n=
bsp;&nbsp;down <FONT color=3D#333399>=3D</FONT> =0ABoard_PBGetSta=
te();<BR>&nbsp;&nbsp;<FONT color=3D#008000>//down =3D =0A(~down)&=
amp;0x1;</FONT><BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff><B>if</B>=
</FONT>(down) <FONT color=3D#008000>// down, =0Aupdate</FONT><BR>=
&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;count <FONT =0Acolor=3D#333399=
>=3D</FONT> clock<FONT color=3D#333399>+</FONT><FONT =0Acolor=3D#=
6e00aa>200</FONT>; <FONT color=3D#008000>// =0A0.2s</FONT><BR>&nb=
sp;&nbsp;}<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff><B>else</B></F=
ONT> <FONT color=3D#0000ff><B>if</B></FONT>(clock<FONT =0Acolor=3D=
#333399>&gt;</FONT><FONT color=3D#333399>=3D</FONT>count) <FONT =0A=
color=3D#008000>// Boot =0Aapp</FONT><BR>&nbsp;&nbsp;{<BR>&nbsp;&=
nbsp;&nbsp;boot_app();<BR>&nbsp;&nbsp;&nbsp;<FONT =0Acolor=3D#008=
000>//break;</FONT><BR>&nbsp;&nbsp;&nbsp;count <FONT =0Acolor=3D#=
333399>=3D</FONT> clock<FONT color=3D#333399>+</FONT><FONT =0Acol=
or=3D#6e00aa>200</FONT>; <FONT color=3D#008000>// =0A0.2s</FONT><=
BR>&nbsp;&nbsp;}<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff><B>if</B=
></FONT>(clock <FONT color=3D#333399>&gt;</FONT> =0Aled)<BR>&nbsp=
;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;led <FONT color=3D#333399>=3D</FONT=
> =0Aclock<FONT color=3D#333399>+</FONT><FONT color=3D#6e00aa>50<=
/FONT>; <FONT =0Acolor=3D#008000>// =0A0.05s</FONT><BR>&nbsp;&nbs=
p;&nbsp;Board_LEDToggle(LED1);<BR>&nbsp;&nbsp;&nbsp;Board_LEDTogg=
le(LED2);<BR>&nbsp;&nbsp;}<BR>&nbsp;}<BR>}</DIV>=0A<P class=3DMso=
Normal =0Astyle=3D"MARGIN: 0cm 0cm 0pt; WORD-SPACING: 0px; FONT:=20=
12px/16px =CB=CE=CC=E5; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0);=20=
TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; or=
phans: auto; widows: auto; webkit-text-stroke-width: 0px"><BR>=C8=
=BB=BA=F3=CE=D2=C3=C7=B0=D1 =0Amain=BA=AF=CA=FD=B8=C4=CE=AA=A3=BA=
<BR></P>=0A<DIV =0Astyle=3D"BORDER-RIGHT: black 1px solid; PADDIN=
G-RIGHT: 3px; BORDER-TOP: black 1px solid; PADDING-LEFT: 3px; FON=
T-SIZE: 12px; MARGIN-LEFT: auto; BORDER-LEFT: black 1px solid; CO=
LOR: black; MARGIN-RIGHT: auto; PADDING-TOP: 3px; BORDER-BOTTOM:=20=
black 1px solid; FONT-FAMILY: Courier New; BACKGROUND-COLOR: wind=
ow; TEXT-ALIGN: left; 3px: "><FONT =0Acolor=3D#0000ff><B>int</B><=
/FONT> main(<FONT =0Acolor=3D#0000ff><B>void</B></FONT>)<BR>{<BR>=
&nbsp;<FONT color=3D#008000>//uint8_t =0Adown=3D0;</FONT><BR>&nbs=
p;Board_LEDInit(LED1);<BR>&nbsp;Board_LEDInit(LED2);<BR>&nbsp;Boa=
rd_PBInit();<BR>&nbsp;code_entry();<BR>&nbsp;uart_init(<FONT =0Ac=
olor=3D#6e00aa>115200</FONT>);<BR>&nbsp;printf(<FONT color=3D#ff0=
0bf>"QiFreeUSBS =0Aversion %s.%s.%s\r\n"</FONT>, VERSION, PATCHLE=
VEL, =0ASUBLEVEL);<BR>&nbsp;&nbsp;USBD_Init(<FONT =0Acolor=3D#333=
399>&amp;</FONT>USB_OTG_dev,<BR>#<FONT =0Acolor=3D#0000ff><B>ifde=
f</B></FONT> =0AUSE_USB_OTG_HS&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USB_OTG_HS_CORE_ID=
,<BR>#<FONT =0Acolor=3D#0000ff><B>else</B></FONT>&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;USB_OTG_FS_CORE_ID,<BR>#<FONT =0Acolor=3D#0000ff><B>endif</B></=
FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>USR_d=
esc,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>USBD_MSC_cb,&=
nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>USR_cb);<BR>=
&nbsp;<BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>while</B></FONT> (<FO=
NT =0Acolor=3D#6e00aa>1</FONT>)<BR>&nbsp;{<BR>&nbsp;&nbsp;Board_L=
EDToggle(LED1);<BR>&nbsp;&nbsp;Board_LEDToggle(LED2);<BR>&nbsp;&n=
bsp;<FONT =0Acolor=3D#008000>//down =3D Board_PBGetState();</FONT=
><BR>&nbsp;&nbsp;<FONT =0Acolor=3D#008000>//down =3D (~down)&amp;=
0x1;</FONT><BR>&nbsp;&nbsp;<FONT =0Acolor=3D#008000>//printf("wai=
tting ...\r\n");</FONT><BR>&nbsp;&nbsp;<FONT =0Acolor=3D#008000>/=
/printf("KEY:%d\r\n", down);</FONT><BR>&nbsp;&nbsp;delay_ms(<FONT=
 =0Acolor=3D#6e00aa>500</FONT>);&nbsp;&nbsp;&nbsp;<BR>&nbsp;}<BR>=
} </DIV>=0A<P class=3DMsoNormal =0Astyle=3D"MARGIN: 0cm 0cm 0pt;=20=
WORD-SPACING: 0px; FONT: 12px/16px =CB=CE=CC=E5; TEXT-TRANSFORM:=20=
none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; L=
ETTER-SPACING: normal; orphans: auto; widows: auto; webkit-text-s=
troke-width: 0px"><BR>=B4=CB=CA=B1=BD=F8=D0=D0=B2=E2=CA=D4=B5=C4=CA=
=B1=BA=F2=D7=D4=C8=BB=B8=D0=BE=F5=B2=BB=B5=BD=D3=D0=B6=E0=B4=F3=B5=
=C4=B1=E4=BB=AF=A3=AC=B3=FD=B7=C7=C4=E3=B5=C4=B0=E5=D7=D3=B8=C9=C8=
=C5=BA=DC=B4=F3=A1=A3<BR><BR>&nbsp;&nbsp;&nbsp; =0A<STRONG><SPAN=20=
id=3Dwiz_font_size_span_28567703 =0Astyle=3D"FONT-SIZE: 16pt"><ST=
RONG>=BD=D3</STRONG></SPAN></STRONG>=CF=C2=C0=B4=CE=D2=C3=C7=D4=D9=
=D4=F6=BC=D3=C1=BD=B8=F6=BA=AF=CA=FD=A3=BA<BR></P>=0A<DIV =0Astyl=
e=3D"BORDER-RIGHT: black 1px solid; PADDING-RIGHT: 3px; BORDER-TO=
P: black 1px solid; PADDING-LEFT: 3px; FONT-SIZE: 12px; MARGIN-LE=
FT: auto; BORDER-LEFT: black 1px solid; COLOR: black; MARGIN-RIGH=
T: auto; PADDING-TOP: 3px; BORDER-BOTTOM: black 1px solid; FONT-F=
AMILY: Courier New; BACKGROUND-COLOR: window; TEXT-ALIGN: left; 3=
px: "><FONT =0Acolor=3D#0000ff><B>void</B></FONT> boot_reset(<FON=
T =0Acolor=3D#0000ff><B>void</B></FONT>)<BR>{<BR>&nbsp;<FONT colo=
r=3D#008000>/* Test if =0Auser code is programmed starting from a=
ddress 0x8003000 */</FONT><BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>i=
f</B></FONT> (((<FONT color=3D#333399>*</FONT>(__IO =0Auint32_t<F=
ONT color=3D#333399>*</FONT>)APP_DEFAULT_ADD) <FONT =0Acolor=3D#3=
33399>&amp;</FONT> 0x2FFE0000 ) <FONT color=3D#333399>=3D=3D</FON=
T> =0A0x20000000)<BR>&nbsp;{<BR>&nbsp;&nbsp;NVIC_SystemReset(); <=
FONT color=3D#008000>// =0AProgram Reset</FONT>&nbsp;<BR>&nbsp;}<=
BR>}&nbsp;<BR><FONT color=3D#008000>// =0Amount</FONT><BR><FONT c=
olor=3D#0000ff><B>static</B></FONT> <FONT =0Acolor=3D#0000ff><B>v=
oid</B></FONT> mount_storage(<FONT =0Acolor=3D#0000ff><B>void</B>=
</FONT>)<BR>{<BR>&nbsp;uint8_t down<FONT =0Acolor=3D#333399>=3D</=
FONT><FONT color=3D#6e00aa>0</FONT>;<BR>&nbsp;<FONT =0Acolor=3D#0=
000ff><B>unsigned</B></FONT> <FONT color=3D#0000ff><B>int</B></FO=
NT> =0Aled<FONT color=3D#333399>=3D</FONT><FONT color=3D#6e00aa>0=
</FONT>;<BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>unsigned</B></FONT>=
 <FONT color=3D#0000ff><B>int</B></FONT> =0Acount<FONT color=3D#3=
33399>=3D</FONT><FONT color=3D#6e00aa>0</FONT>;<BR>&nbsp;<FONT =0A=
color=3D#0000ff><B>unsigned</B></FONT> <FONT color=3D#0000ff><B>i=
nt</B></FONT> =0Aclock<FONT color=3D#333399>=3D</FONT><FONT =0Aco=
lor=3D#6e00aa>0</FONT>;<BR>&nbsp;&nbsp;USBD_Init(<FONT =0Acolor=3D=
#333399>&amp;</FONT>USB_OTG_dev,<BR>#<FONT =0Acolor=3D#0000ff><B>=
ifdef</B></FONT> =0AUSE_USB_OTG_HS&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USB_OTG_HS_COR=
E_ID,<BR>#<FONT =0Acolor=3D#0000ff><B>else</B></FONT>&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;USB_OTG_FS_CORE_ID,<BR>#<FONT =0Acolor=3D#0000ff><B>endif</=
B></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>U=
SR_desc,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>USBD_MSC_=
cb,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;<FONT =0Acolor=3D#333399>&amp;</FONT>USR_cb);=
<BR>&nbsp;printf(<FONT color=3D#ff00bf>"main =0A...\r\n"</FONT>);=
<BR>&nbsp;clock <FONT color=3D#333399>=3D</FONT> <FONT =0Acolor=3D=
#6e00aa>0</FONT>;<BR>&nbsp;count <FONT color=3D#333399>=3D</FONT>=
 clock<FONT =0Acolor=3D#333399>+</FONT><FONT color=3D#6e00aa>200<=
/FONT>; <FONT color=3D#008000>// =0A0.2s</FONT><BR>&nbsp;led <FON=
T color=3D#333399>=3D</FONT> clock<FONT =0Acolor=3D#333399>+</FON=
T><FONT color=3D#6e00aa>50</FONT>; <FONT color=3D#008000>// =0A0.=
05s</FONT><BR>&nbsp;<FONT color=3D#0000ff><B>while</B></FONT>(<FO=
NT =0Acolor=3D#6e00aa>1</FONT>)<BR>&nbsp;{<BR>&nbsp;&nbsp;delay_m=
s(<FONT =0Acolor=3D#6e00aa>10</FONT>);<BR>&nbsp;&nbsp;clock <FONT=
 color=3D#333399>+=3D</FONT> =0A<FONT color=3D#6e00aa>10</FONT>;=20=
<FONT color=3D#008000>// update =0Aclock</FONT><BR>&nbsp;&nbsp;do=
wn <FONT color=3D#333399>=3D</FONT> =0ABoard_PBGetState();<BR>&nb=
sp;&nbsp;<FONT color=3D#0000ff><B>if</B></FONT>(down) =0A<FONT co=
lor=3D#008000>// down, =0Aupdate</FONT><BR>&nbsp;&nbsp;{<BR>&nbsp=
;&nbsp;&nbsp;count <FONT =0Acolor=3D#333399>=3D</FONT> clock<FONT=
 color=3D#333399>+</FONT><FONT =0Acolor=3D#6e00aa>1000</FONT>; <F=
ONT color=3D#008000>// =0A1s</FONT><BR>&nbsp;&nbsp;}<BR>&nbsp;&nb=
sp;<FONT color=3D#0000ff><B>else</B></FONT> =0A<FONT color=3D#000=
0ff><B>if</B></FONT>(clock<FONT color=3D#333399>&gt;</FONT><FONT=20=
=0Acolor=3D#333399>=3D</FONT>count) <FONT color=3D#008000>// Boot=
 =0Aapp</FONT><BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;printf(<FONT=
 =0Acolor=3D#ff00bf>"boot =0Aapp\r\n"</FONT>);<BR>&nbsp;&nbsp;&nb=
sp;boot_reset();<BR>&nbsp;&nbsp;&nbsp;count =0A<FONT color=3D#333=
399>=3D</FONT> clock<FONT color=3D#333399>+</FONT><FONT =0Acolor=3D=
#6e00aa>1000</FONT>; <FONT color=3D#008000>// =0A1s</FONT><BR>&nb=
sp;&nbsp;}<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff><B>if</B></FON=
T>(clock <FONT color=3D#333399>&gt;</FONT> =0Aled)<BR>&nbsp;&nbsp=
;{<BR>&nbsp;&nbsp;&nbsp;led <FONT color=3D#333399>=3D</FONT> =0Ac=
lock<FONT color=3D#333399>+</FONT><FONT color=3D#6e00aa>300</FONT=
>; <FONT =0Acolor=3D#008000>// =0A0.06s</FONT><BR>&nbsp;&nbsp;&nb=
sp;Board_LEDToggle(LED1);<BR>&nbsp;&nbsp;&nbsp;Board_LEDToggle(LE=
D2);<BR>&nbsp;&nbsp;}<BR>&nbsp;}<BR>}</DIV>=0A<P class=3DMsoNorma=
l =0Astyle=3D"MARGIN: 0cm 0cm 0pt; WORD-SPACING: 0px; FONT: 12px/=
16px =CB=CE=CC=E5; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-=
INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphans=
: auto; widows: auto; webkit-text-stroke-width: 0px"><BR>=B6=F8 =0A=
main=BA=AF=CA=FD=CE=D2=C3=C7=BE=CD=D2=AA=B8=C4=CE=AA=A3=BA<BR></P=
>=0A<DIV =0Astyle=3D"BORDER-RIGHT: black 1px solid; PADDING-RIGHT=
: 3px; BORDER-TOP: black 1px solid; PADDING-LEFT: 3px; FONT-SIZE:=
 12px; MARGIN-LEFT: auto; BORDER-LEFT: black 1px solid; COLOR: bl=
ack; MARGIN-RIGHT: auto; PADDING-TOP: 3px; BORDER-BOTTOM: black 1=
px solid; FONT-FAMILY: Courier New; BACKGROUND-COLOR: window; TEX=
T-ALIGN: left; 3px: "><FONT =0Acolor=3D#0000ff><B>int</B></FONT>=20=
main(<FONT =0Acolor=3D#0000ff><B>void</B></FONT>)<BR>{<BR>&nbsp;<=
FONT color=3D#008000>//uint8_t =0Adown=3D0;</FONT><BR>&nbsp;Board=
_LEDInit(LED1);<BR>&nbsp;Board_LEDInit(LED2);<BR>&nbsp;Board_PBIn=
it();<BR>&nbsp;code_entry();<BR>&nbsp;uart_init(<FONT =0Acolor=3D=
#6e00aa>115200</FONT>);<BR>&nbsp;printf(<FONT color=3D#ff00bf>"Qi=
FreeUSBS =0Aversion %s.%s.%s\r\n"</FONT>, VERSION, PATCHLEVEL, =0A=
SUBLEVEL);<BR>&nbsp;mount_storage();&nbsp;<BR>&nbsp;<FONT =0Acolo=
r=3D#0000ff><B>while</B></FONT> (<FONT =0Acolor=3D#6e00aa>1</FONT=
>)<BR>&nbsp;{<BR>&nbsp;&nbsp;Board_LEDToggle(LED1);<BR>&nbsp;&nbs=
p;Board_LEDToggle(LED2);<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#008000>=
//down =3D Board_PBGetState();</FONT><BR>&nbsp;&nbsp;<FONT =0Acol=
or=3D#008000>//down =3D (~down)&amp;0x1;</FONT><BR>&nbsp;&nbsp;<F=
ONT =0Acolor=3D#008000>//printf("waitting ...\r\n");</FONT><BR>&n=
bsp;&nbsp;<FONT =0Acolor=3D#008000>//printf("KEY:%d\r\n", down);<=
/FONT><BR>&nbsp;&nbsp;delay_ms(<FONT =0Acolor=3D#6e00aa>500</FONT=
>);&nbsp;&nbsp;&nbsp;<BR>&nbsp;}<BR>} </DIV>=0A<P class=3DMsoNorm=
al =0Astyle=3D"MARGIN: 0cm 0cm 0pt; WORD-SPACING: 0px; FONT: 12px=
/16px =CB=CE=CC=E5; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT=
-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; orphan=
s: auto; widows: auto; webkit-text-stroke-width: 0px"><BR>=D5=E2=D1=
=F9=B5=B1=CE=D2=C3=C7=B0=B4=CF=C2=B0=B4=BC=FC=B5=C4=CA=B1=BA=F2=BE=
=CD=BF=C9=D2=D4=D7=D4=B6=AF=C8=A5=D2=FD=B5=BC =0AApp=A1=A3=BF=C9=C4=
=DC=C4=E3=BB=E1=BE=F5=B5=C3=CE=AA=CA=B2=C3=B4=D2=AA=CA=B9=D3=C3=C8=
=ED=BC=FE=B8=B4=CE=BB=B6=F8=B2=BB=D6=B1=BD=D3=D2=FD=B5=BC App=A3=BF=
=D4=AD=D2=F2=D4=DA=D3=DA=D5=E2=CA=B1=BA=F2=C4=E3=D2=D1=BE=AD=B3=F5=
=CA=BC=BB=AF=C1=CB=BA=DC=B6=E0=CD=E2=C9=E8=A3=AC=C8=E7=B4=AE=BF=DA=
=B8=FA =0AUSB=A3=AC=C8=ED=BC=FE=B8=B4=CE=BB=BF=C9=D2=D4=B0=D1=D5=E2=
=D0=A9=D2=D1=BE=AD=B4=F2=BF=AA=B5=C4=CD=E2=C9=E8=B6=BC=B8=F8=C7=E5=
=B5=F4=A3=AC=D7=EE=BA=F3=BE=CD=D6=BB=CA=A3=CF=C2=C1=CB LED=B8=FA=20=
KEY=A1=A3<BR><BR>&nbsp;&nbsp;&nbsp; =0A<STRONG><SPAN id=3Dwiz_fon=
t_size_span_29238046 =0Astyle=3D"FONT-SIZE: 16pt"><STRONG>=B2=BB<=
/STRONG></SPAN></STRONG>=B9=FD=D5=E2=B8=F6=CA=B1=BA=F2=CE=D2=BE=F5=
=B5=C3=BB=B9=CA=C7=B2=BB=B9=BB=A3=AC=BB=B9=C9=D9=C1=CB=D2=BB=B8=F6=
=B6=AB=CE=F7=A3=BA=D7=B4=CC=AC=D6=B8=CA=BE=A3=A1=BE=CD=CA=C7=CB=B5=
=CE=D2=C3=C7=C3=BB=D3=D0=C7=F8=B7=D6 =0AUSBS=B5=C4=BF=D5=CF=D0=D7=
=B4=CC=AC=B8=FA=CF=C2=D4=D8=D7=B4=CC=AC=A1=A3=CB=F9=D2=D4=CE=D2=C3=
=C7=BC=CC=D0=F8=D4=F6=BC=D3=C8=E7=CF=C2=B4=FA=C2=EB=A3=BA<BR></P>=
=0A<DIV =0Astyle=3D"BORDER-RIGHT: black 1px solid; PADDING-RIGHT:=
 3px; BORDER-TOP: black 1px solid; PADDING-LEFT: 3px; FONT-SIZE:=20=
12px; MARGIN-LEFT: auto; BORDER-LEFT: black 1px solid; COLOR: bla=
ck; MARGIN-RIGHT: auto; PADDING-TOP: 3px; BORDER-BOTTOM: black 1p=
x solid; FONT-FAMILY: Courier New; BACKGROUND-COLOR: window; TEXT=
-ALIGN: left; 3px: "><FONT =0Acolor=3D#0000ff><B>static</B></FONT=
> <FONT color=3D#0000ff><B>int</B></FONT> =0ADownLoadFlag<FONT co=
lor=3D#333399>=3D</FONT><FONT color=3D#6e00aa>0</FONT>;<BR><FONT=20=
=0Acolor=3D#0000ff><B>void</B></FONT> DownLoadStatus(<FONT =0Acol=
or=3D#0000ff><B>void</B></FONT>)<BR>{<BR>&nbsp;DownLoadFlag <FONT=
 =0Acolor=3D#333399>=3D</FONT> <FONT =0Acolor=3D#6e00aa>1</FONT>;=
<BR>&nbsp;Board_LEDOn(LED1);<BR>&nbsp;Board_LEDOn(LED2);<BR>}<BR>=
<FONT =0Acolor=3D#008000>=0A<HR>=0A// mount_storage</FONT><BR>&nb=
sp;<FONT color=3D#0000ff><B>while</B></FONT>(<FONT =0Acolor=3D#6e=
00aa>1</FONT>)<BR>&nbsp;{<BR>&nbsp;&nbsp;<FONT =0Acolor=3D#0000ff=
><B>while</B></FONT>(DownLoadFlag)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbs=
p;&nbsp;DownLoadFlag =0A<FONT color=3D#333399>=3D</FONT> <FONT =0A=
color=3D#6e00aa>0</FONT>;<BR>&nbsp;&nbsp;&nbsp;Board_LEDOn(LED1);=
<BR>&nbsp;&nbsp;&nbsp;Board_LEDOn(LED2);<BR>&nbsp;&nbsp;&nbsp;del=
ay_ms(<FONT =0Acolor=3D#6e00aa>1000</FONT>);<BR>&nbsp;&nbsp;}<BR>=
&nbsp;&nbsp;delay_ms(<FONT =0Acolor=3D#6e00aa>10</FONT>);<BR>&nbs=
p;&nbsp;clock <FONT color=3D#333399>+=3D</FONT> =0A<FONT color=3D=
#6e00aa>10</FONT>; <FONT color=3D#008000>// update clock</DIV>=0A=
<P class=3DMsoNormal =0Astyle=3D"MARGIN: 0cm 0cm 0pt; WORD-SPACIN=
G: 0px; FONT: 12px/16px =CB=CE=CC=E5; TEXT-TRANSFORM: none; COLOR=
: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACI=
NG: normal; orphans: auto; widows: auto; webkit-text-stroke-width=
: 0px"></FONT><BR>=C8=BB=BA=F3=CE=D2=C3=C7=D4=D9=B0=D1 =0ASTORAGE=
_Write=BA=AF=CA=FD=B8=C4=CE=AA=A3=BA<BR></P>=0A<DIV =0Astyle=3D"B=
ORDER-RIGHT: black 1px solid; PADDING-RIGHT: 3px; BORDER-TOP: bla=
ck 1px solid; PADDING-LEFT: 3px; FONT-SIZE: 12px; MARGIN-LEFT: au=
to; BORDER-LEFT: black 1px solid; COLOR: black; MARGIN-RIGHT: aut=
o; PADDING-TOP: 3px; BORDER-BOTTOM: black 1px solid; FONT-FAMILY:=
 Courier New; BACKGROUND-COLOR: window; TEXT-ALIGN: left; 3px: ">=
int8_t =0ASTORAGE_Write (uint8_t =0Alun,&nbsp;<BR>&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t =0A<FONT =0Acolor=3D#333399>*=
</FONT>buf,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u=
int32_t =0Ablk_addr,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;uint16_t =0Ablk_len)<BR>{<BR>&nbsp;int8_t ret <FONT color=3D#33=
3399>=3D</FONT> <FONT =0Acolor=3D#6e00aa>0</FONT>;&nbsp;<BR>&nbsp=
;uint32_t Memory_Offset <FONT =0Acolor=3D#333399>=3D</FONT> blk_a=
ddr<FONT color=3D#333399>*</FONT><FONT =0Acolor=3D#6e00aa>512</FO=
NT>;<BR>&nbsp;<FONT color=3D#008000>//printf("@%s [%d]addr: =0A%0=
3dK | %04d\r\n", __func__, lun, (blk_addr*512)/1024, =0Ablk_len*5=
12);</FONT><BR>&nbsp;check_Sojiro(Memory_Offset, (<FONT =0Acolor=3D=
#0000ff><B>char</B></FONT><FONT color=3D#333399>*</FONT>)buf, blk=
_len<FONT =0Acolor=3D#333399>*</FONT><FONT color=3D#6e00aa>512</F=
ONT>);<BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>if</B></FONT>(RAM_FAT=
32_Offset<FONT =0Acolor=3D#333399>&gt;</FONT>Memory_Offset) <FONT=
 color=3D#008000>// FAT32 =3D=3D&gt; =0ASRAM</FONT><BR>&nbsp;{<BR=
>&nbsp;&nbsp;ret<FONT =0Acolor=3D#333399>=3D</FONT>SRAM_Write(buf=
, blk_addr<FONT color=3D#333399>*</FONT><FONT =0Acolor=3D#6e00aa>=
512</FONT>, blk_len<FONT color=3D#333399>*</FONT><FONT =0Acolor=3D=
#6e00aa>512</FONT>);<BR>&nbsp;}<BR>&nbsp;<FONT =0Acolor=3D#0000ff=
><B>else</B></FONT><BR>&nbsp;{<BR>&nbsp;&nbsp;DownLoadStatus();<B=
R>&nbsp;&nbsp;Memory_Offset =0A<FONT color=3D#333399>-=3D</FONT>=20=
=0A(uint32_t)RAM_FAT32_Offset;<BR>&nbsp;&nbsp;ret<FONT =0Acolor=3D=
#333399>=3D</FONT>Flash_Write(FLASH_SAVE_ADDR<FONT =0Acolor=3D#33=
3399>+</FONT>Memory_Offset,(u32<FONT color=3D#333399>*</FONT>)buf=
, =0A(blk_len<FONT color=3D#333399>*</FONT><FONT color=3D#6e00aa>=
512</FONT>)<FONT =0Acolor=3D#333399>/</FONT><FONT color=3D#6e00aa=
>4</FONT>);<BR>&nbsp;}<BR>&nbsp;<FONT =0Acolor=3D#0000ff><B>retur=
n</B></FONT> ret;<BR>}</DIV>=0A<P class=3DMsoNormal =0Astyle=3D"M=
ARGIN: 0cm 0cm 0pt; WORD-SPACING: 0px; FONT: 12px/16px =CB=CE=CC=E5=
; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHIT=
E-SPACE: normal; LETTER-SPACING: normal; orphans: auto; widows: a=
uto; webkit-text-stroke-width: 0px"><BR>=D5=E2=D1=F9=B5=B1=CE=D2=C3=
=C7=D4=DA=CF=C2=D4=D8=B9=CC=BC=FE(=CD=F9Flash=D6=D0=D0=B4=CA=FD=BE=
=DD)=B5=C4=CA=B1=BA=F2=BE=CD=BF=C9=D2=D4=BF=B4=B5=BD =0ALED=CA=C7=
=B3=A3=C1=C1=B5=C4=A1=A3<BR><BR><BR></P></BODY></HTML>=0A

------=_Next_Part_0058331781.436--

------=_Next_Part_0174995343.827--

